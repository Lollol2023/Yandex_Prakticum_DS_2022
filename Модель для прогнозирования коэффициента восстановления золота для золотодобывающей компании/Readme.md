# Модель для прогнозирования коэффициента восстановления золота для золотодобывающей компании

## Постановка задачи

Необходимо подготовить прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. В распоряжении - данные с параметрами добычи и очистки.

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Задачи:

- Подготовить данные;
- Провести исследовательский анализ данных;
- Построить и обучить модель.

## Описание данных
### Технологический процесс:

- `Rougher feed` — исходное сырье
- `Rougher additions` (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
- `Xanthate xx` — ксантогенат (промотер, или активатор флотации);
- `Sulphate` — сульфат (на данном производстве сульфид натрия);
- `Depressant` — депрессант (силикат натрия).
- `Rougher process` (англ. «грубый процесс») — флотация
- `Rougher tails` — отвальные хвосты
- `Float banks` — флотационная установка
- `Cleaner process` — очистка
- `Rougher Au` — черновой концентрат золота
- `Final Au` — финальный концентрат золота

### Параметры этапов:
- `air amount` — объём воздуха
- `fluid levels` — уровень жидкости
- `feed size` — размер гранул сырья
- `feed rate` — скорость подачи

### Наименование признаков 

**Возможные значения для блока [этап]:**

- `rougher` — флотация
- `primary_cleaner` — первичная очистка
- `secondary_cleaner` — вторичная очистка
- `final` — финальные характеристики

**Возможные значения для блока [тип_параметра]:**

- `input` — параметры сырья
- `output` — параметры продукта
- `state` — параметры, характеризующие текущее состояние этапа
- `calculation` — расчётные характеристики

Данные находятся в трёх файлах:

- data_1.csv — обучающая выборка;
- data_2.csv — тестовая выборка;
- data_3.csv — исходные данные.

Данные индексируются датой и временем получения информации (признак date).

Соседние по времени параметры часто похожи.

Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже.

Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей.

Также в тестовом наборе нет целевых признаков.

Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.

Прежде чем приступить к построению модели, необходимо проверить их на корректность.

## Вывод

Проведя изучение, предобработку и анализ данных, мы можем сформулировать следующие выводы:

- формула расчета эффективности обогащения составлена верно.
- концентрация золота постепенно растет после каждого этапа обогащения.
- концентрация серебра после флотации увеличивается, т.к. серебро хорошо извлекается на этапе флотации. На последующих этапах коцентрация снижается.
- концентрация свинца увеличиается последовательно с каждым этапом очистки. свинец является катализатором процесса очистки золота.
- концентрация силумина в процессе очистки уменьшается.

При подсчете суммарной концентрации металлов после разных этапов очистки мы лбнаружили нулевые значения, которые могут свидетельствовать о неправильной работе датчиков или оборудовния.

В ходе поиска оптимальной модели, которая должна предсказать коэффициент восстановления золота из золотосодержащей руды, мы тестировали следующие варианты:

- Линейная регрессия,
- Дерево решений,
- Дополнительные деревья (со стандартными и подобранными гиперпараметрами),
- Случайный лес,
- Лассо,
- CatBoostRegressor

Наилучшие показания sMAPE (требуемая метрика качества модели) - у модели CatBoostRegressor (стандартные гиперпараметры) - 7% вероятности ошибки.

## Используемые инструменты

`pandas` `plotly`  `LightGBM` `catboost` `sklearn` `matplotlib` `seaborn` `numpy`
